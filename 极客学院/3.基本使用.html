<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 5.1.6.2 (Linux)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="2017-10-13T17:25:03.681667451"/>
	<meta name="" content=""/>
	<style type="text/css">
		pre.ctl { font-family: "Liberation Mono", monospace }
		code.ctl { font-family: "Liberation Mono", monospace }
	</style>
</head>
<body lang="zh-CN" dir="ltr">
<p><a href="http://wiki.jikexueyuan.com/project/tensorflow-zh/"><span style="background: #ffff00">原文链接</span></a></p>
<p><span style="background: #ffff00">极客学院团队出品 <font face="Liberation Serif, serif"><span lang="en-US">·
</span></font>更新于 <font face="Liberation Serif, serif"><span lang="en-US">2017-10-13
11:00:26</span></span></font></p>
<h1><a name="AUTOGENERATED-basic-usage"></a><span style="background: #ffff00">基本使用
</span>
</h1>
<p><span style="background: #ffff00">使用 <font face="Liberation Serif, serif"><span lang="en-US">TensorFlow,
</span></font>你必须明白 <font face="Liberation Serif, serif"><span lang="en-US">TensorFlow:</span></span></font></p>
<ul>
	<li/>
<p style="margin-bottom: 0cm"><span style="background: #ffff00">使用图
	<font face="Liberation Serif, serif"><span lang="en-US">(graph)
	</span></font>来表示计算任务<font face="Liberation Serif, serif"><span lang="en-US">.
	</span></span></font>
	</p>
	<li/>
<p style="margin-bottom: 0cm"><span style="background: #ffff00">在被称之为
	</span><code class="cjk"><span style="background: #ffff00">会话
	</code><font face="Liberation Serif, serif"><span lang="en-US"><code class="western">(Session)</span></code><span style="background: #ffff00">
	</span></span></font><span style="background: #ffff00">的上下文
	<font face="Liberation Serif, serif"><span lang="en-US">(context)
	</span></font>中执行图<font face="Liberation Serif, serif"><span lang="en-US">.
	</span></span></font>
	</p>
	<li/>
<p style="margin-bottom: 0cm"><span style="background: #ffff00">使用
	<font face="Liberation Serif, serif"><span lang="en-US">tensor </span></font>表示数据<font face="Liberation Serif, serif"><span lang="en-US">.
	</span></span></font>
	</p>
	<li/>
<p style="margin-bottom: 0cm"><span style="background: #ffff00">通过
	</span><code class="cjk"><span style="background: #ffff00">变量
	</code><font face="Liberation Serif, serif"><span lang="en-US"><code class="western">(Variable)</span></code><span style="background: #ffff00">
	</span></span></font><span style="background: #ffff00">维护状态<font face="Liberation Serif, serif"><span lang="en-US">.
	</span></span></font>
	</p>
	<li/>
<p><span style="background: #ffff00">使用 <font face="Liberation Serif, serif"><span lang="en-US">feed
	</span></font>和 <font face="Liberation Serif, serif"><span lang="en-US">fetch
	</span></font>可以为任意的操作<font face="Liberation Serif, serif"><span lang="en-US">(arbitrary
	operation) </span></font>赋值或者从其中获取数据<font face="Liberation Serif, serif"><span lang="en-US">.
	</span></span></font>
	</p>
</ul>
<h2><a name="19c5343c8714bb99bb4261e304ad1112"></a><a name="AUTOGENERATED-overview"></a>
<span style="background: #ffff00">综述 </span>
</h2>
<p><font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">TensorFlow
</span></font>是一个编程系统<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>使用图来表示计算任务<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>图中的节点被称之为 </span><font face="Liberation Serif, serif"><span lang="en-US"><em><span style="background: #ffff00">op</span></em><span style="background: #ffff00">
(operation </span></span></font><span style="background: #ffff00">的缩写<font face="Liberation Serif, serif"><span lang="en-US">).</span>
</span></font><span style="background: #ffff00">一个 <font face="Liberation Serif, serif"><span lang="en-US">op
</span></font>获得 <font face="Liberation Serif, serif"><span lang="en-US">0
</span></font>个或多个 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">Tensor</span></code><span style="background: #ffff00">,
</span></span></font><span style="background: #ffff00">执行计算<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>产生 <font face="Liberation Serif, serif"><span lang="en-US">0
</span></font>个或多个 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">Tensor</span></code><span style="background: #ffff00">.
</span></span></font><span style="background: #ffff00">每个 <font face="Liberation Serif, serif"><span lang="en-US">Tensor
</span></font>是一个类型化的多维数组<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>例如<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>你可以将一小组图像集表示为一个四维浮点数数组<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>这四个维度分别是</span> <font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">[batch,
height, width, channels]</span></code><span style="background: #ffff00">.</span></span></font></p>
<p><span style="background: #ffff00">一个 <font face="Liberation Serif, serif"><span lang="en-US">TensorFlow
</span></font>图</span><em><span style="background: #ffff00">描述</span></em><span style="background: #ffff00">了计算的过程<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>为了进行计算<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>图必须在 </span><code class="cjk"><span style="background: #ffff00">会话</span></code><span style="background: #ffff00">
里被启动<font face="Liberation Serif, serif"><span lang="en-US">.
</span></span></font><code class="cjk"><span style="background: #ffff00">会话</span></code><span style="background: #ffff00">
将图的 <font face="Liberation Serif, serif"><span lang="en-US">op
</span></font>分发到诸如 <font face="Liberation Serif, serif"><span lang="en-US">CPU
</span></font>或 <font face="Liberation Serif, serif"><span lang="en-US">GPU
</span></font>之类的 </span><code class="cjk"><span style="background: #ffff00">设备</span></code><span style="background: #ffff00">
上<font face="Liberation Serif, serif"><span lang="en-US">, </span></font>同时提供执行
<font face="Liberation Serif, serif"><span lang="en-US">op </span></font>的方法<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>这些方法执行后<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>将产生的 <font face="Liberation Serif, serif"><span lang="en-US">tensor</span>
</span></font><span style="background: #ffff00">返回<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>在 <font face="Liberation Serif, serif"><span lang="en-US">Python
</span></font>语言中<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>返回的 <font face="Liberation Serif, serif"><span lang="en-US">tensor
</span></font>是 <font face="Liberation Serif, serif"><span lang="en-US"><a href="http://www.numpy.org/">numpy</a>
</span><code class="western"><span style="background: #ffff00">ndarray</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">对象<font face="Liberation Serif, serif"><span lang="en-US">;
</span></font>在 <font face="Liberation Serif, serif"><span lang="en-US">C
</span></font>和 <font face="Liberation Serif, serif"><span lang="en-US">C++
</span></font>语言中<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>返回的 <font face="Liberation Serif, serif"><span lang="en-US">tensor</span>
</span></font><span style="background: #ffff00">是
</span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">tensorflow::Tensor</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">实例<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<h2><a name="ef2e02befb3a93383ed40cff2a63a343"></a><a name="AUTOGENERATED-the-computation-graph"></a>
<span style="background: #ffff00">计算图 </span>
</h2>
<p><font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">TensorFlow
</span></font>程序通常被组织成一个构建阶段和一个执行阶段<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>在构建阶段<font face="Liberation Serif, serif"><span lang="en-US">,
op </span></font>的执行步骤 被描述成一个图<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>在执行阶段<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>使用会话执行执行图中的 <font face="Liberation Serif, serif"><span lang="en-US">op.</span></span></font></p>
<p><span style="background: #ffff00">例如<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>通常在构建阶段创建一个图来表示和训练神经网络<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>然后在执行阶段反复执行图中的训练 <font face="Liberation Serif, serif"><span lang="en-US">op.</span></span></font></p>
<p><font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">TensorFlow
</span></font>支持 <font face="Liberation Serif, serif"><span lang="en-US">C,
C++, Python </span></font>编程语言<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>目前<font face="Liberation Serif, serif"><span lang="en-US">,
TensorFlow </span></font>的 <font face="Liberation Serif, serif"><span lang="en-US">Python
</span></font>库更加易用<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>它提供了大量的辅助函数来简化构建图的工作<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>这些函数尚未被 <font face="Liberation Serif, serif"><span lang="en-US">C
</span></font>和 <font face="Liberation Serif, serif"><span lang="en-US">C++
</span></font>库支持<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<p><span style="background: #ffff00">三种语言的会话库
<font face="Liberation Serif, serif"><span lang="en-US">(session
libraries) </span></font>是一致的<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<h3><a name="AUTOGENERATED-building-the-graph"></a><span style="background: #ffff00">构建图
</span>
</h3>
<p><span style="background: #ffff00">构建图的第一步<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>是创建源 <font face="Liberation Serif, serif"><span lang="en-US">op
(source op). </span></font>源 <font face="Liberation Serif, serif"><span lang="en-US">op
</span></font>不需要任何输入<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>例如 </span><code class="cjk"><span style="background: #ffff00">常量
</code><font face="Liberation Serif, serif"><span lang="en-US"><code class="western">(Constant)</span></code><span style="background: #ffff00">.
</span></span></font><span style="background: #ffff00">源 <font face="Liberation Serif, serif"><span lang="en-US">op</span>
</span></font><span style="background: #ffff00">的输出被传递给其它
<font face="Liberation Serif, serif"><span lang="en-US">op </span></font>做运算<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<p><font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">Python
</span></font>库中<font face="Liberation Serif, serif"><span lang="en-US">,
op </span></font>构造器的返回值代表被构造出的 <font face="Liberation Serif, serif"><span lang="en-US">op
</span></font>的输出<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>这些返回值可以传递给其它 <font face="Liberation Serif, serif"><span lang="en-US">op
</span></font>构造器作为输入<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<p><font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">TensorFlow
Python </span></font>库有一个</span><em><span style="background: #ffff00">默认图
<font face="Liberation Serif, serif"><span lang="en-US">(default
graph)</span></em><span style="background: #ffff00">, op </span></span></font><span style="background: #ffff00">构造器可以为其增加节点<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>这个默认图对 许多程序来说已经足够用了<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>阅读 <font face="Liberation Serif, serif"><span lang="en-US"><a href="../api_docs/python/framework.html">Graph
</span></font>类</a> 文档 来了解如何管理多个图<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<pre class="cjk"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">import tensorflow as tf</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">创建一个常量 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op, </code></span></font><code class="cjk">产生一个 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">1x2 </code></span></font><code class="cjk">矩阵</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">. </code></span></font><code class="cjk">这个 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op </code></span></font><code class="cjk">被作为一个节点</span></code>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">加到默认图中</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">#</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">构造器的返回值代表该常量 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op </code></span></font><code class="cjk">的返回值</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">matrix1 = tf.constant([[3., 3.]])</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">创建另外一个常量 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op, </code></span></font><code class="cjk">产生一个 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">2x1 </code></span></font><code class="cjk">矩阵</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">matrix2 = tf.constant([[2.],[2.]])</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">创建一个矩阵乘法 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">matmul op , </code></span></font><code class="cjk">把 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'matrix1' </code></span></font><code class="cjk">和 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'matrix2' </code></span></font><code class="cjk">作为输入</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">返回值 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'product' </code></span></font><code class="cjk">代表矩阵乘法的结果</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">product = tf.matmul(matrix1, matrix2)</span></code></span></font></pre><p>
<span style="background: #ffff00">默认图现在有三个节点<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>两个 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">constant()</span></code><span style="background: #ffff00">
op, </span></span></font><span style="background: #ffff00">和一个</span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">matmul()</span></code><span style="background: #ffff00">
op. </span></span></font><span style="background: #ffff00">为了真正进行矩阵相乘运算<font face="Liberation Serif, serif"><span lang="en-US">,</span>
</span></font><span style="background: #ffff00">并得到矩阵乘法的
结果<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>你必须在会话里启动这个图<font face="Liberation Serif, serif"><span lang="en-US">.
</span></span></font>
</p>
<h3><a name="AUTOGENERATED-launching-the-graph-in-a-session"></a><span style="background: #ffff00">在一个会话中启动图
</span>
</h3>
<p><span style="background: #ffff00">构造阶段完成后<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>才能启动图<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>启动图的第一步是创建一个 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">Session</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">对象<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>如果无任何创建参数<font face="Liberation Serif, serif"><span lang="en-US">,</span>
</span></font><span style="background: #ffff00">会话构造器将启动默认图<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<p><span style="background: #ffff00">欲了解完整的会话 <font face="Liberation Serif, serif"><span lang="en-US">API,
</span></font>请阅读<font face="Liberation Serif, serif"><span lang="en-US"><a href="../api_docs/python/client.html">Session
</span></font>类</a><font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<pre class="cjk"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">启动默认图</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">sess = tf.Session()</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">调用 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">sess </code></span></font><code class="cjk">的 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'run()' </code></span></font><code class="cjk">方法来执行矩阵乘法 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op, </code></span></font><code class="cjk">传入 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'product' </code></span></font><code class="cjk">作为该方法的参数</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">. </span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">上面提到</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">, 'product' </code></span></font><code class="cjk">代表了矩阵乘法 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op </code></span></font><code class="cjk">的输出</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">, </code></span></font><code class="cjk">传入它是向方法表明</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">, </code></span></font><code class="cjk">我们希望取回</span></code>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">矩阵乘法 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op </code></span></font><code class="cjk">的输出</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">#</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">整个执行过程是自动化的</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">, </code></span></font><code class="cjk">会话负责传递 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op </code></span></font><code class="cjk">所需的全部输入</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">. op </code></span></font><code class="cjk">通常是并发执行的</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">函数调用 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'run(product)' </code></span></font><code class="cjk">触发了图中三个 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op (</code></span></font><code class="cjk">两个常量 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op </code></span></font><code class="cjk">和一个矩阵乘法 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op) </code></span></font><code class="cjk">的执行</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">#</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">返回值 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'result' </code></span></font><code class="cjk">是一个 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">numpy `ndarray` </code></span></font><code class="cjk">对象</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">result = sess.run(product)</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">print result</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># ==&gt; [[ 12.]]</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">任务完成</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">, </code></span></font><code class="cjk">关闭会话</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">sess.close()</span></code></span></font></pre><p>
<font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">Session</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">对象在使用完后需要关闭以释放资源<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>除了显式调用 <font face="Liberation Serif, serif"><span lang="en-US">close
</span></font>外<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>也可以使用 <font face="Liberation Serif, serif"><span lang="en-US">&quot;with&quot;
</span></font>代码块</span> <span style="background: #ffff00">来自动完成关闭动作<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<pre class="cjk"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">with tf.Session() as sess:</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">  </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">result = sess.run([product])</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">  </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">print result</span></code></span></font></pre><p>
<span style="background: #ffff00">在实现上<font face="Liberation Serif, serif"><span lang="en-US">,
TensorFlow </span></font>将图形定义转换成分布式执行的操作<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>以充分利用可用的计算资源<font face="Liberation Serif, serif"><span lang="en-US">(</span></font>如
<font face="Liberation Serif, serif"><span lang="en-US">CPU</span> </span></font><span style="background: #ffff00">或
<font face="Liberation Serif, serif"><span lang="en-US">GPU).
</span></font>一般你不需要显式指定使用 <font face="Liberation Serif, serif"><span lang="en-US">CPU
</span></font>还是 <font face="Liberation Serif, serif"><span lang="en-US">GPU,
TensorFlow </span></font>能自动检测<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>如果检测到 <font face="Liberation Serif, serif"><span lang="en-US">GPU,</span>
<span style="background: #ffff00">TensorFlow </span></span></font><span style="background: #ffff00">会尽可能地利用找到的第一个
<font face="Liberation Serif, serif"><span lang="en-US">GPU </span></font>来执行操作<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<p><span style="background: #ffff00">如果机器上有超过一个可用的
<font face="Liberation Serif, serif"><span lang="en-US">GPU, </span></font>除第一个外的其它
<font face="Liberation Serif, serif"><span lang="en-US">GPU
</span></font>默认是不参与计算的<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>为了让</span> <font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">TensorFlow
</span></font>使用这些 <font face="Liberation Serif, serif"><span lang="en-US">GPU,
</span></font>你必须将 <font face="Liberation Serif, serif"><span lang="en-US">op
</span></font>明确指派给它们执行<font face="Liberation Serif, serif"><span lang="en-US">.
</span><code class="western"><span style="background: #ffff00">with...Device</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">语句用来指派特定的
<font face="Liberation Serif, serif"><span lang="en-US">CPU </span></font>或
<font face="Liberation Serif, serif"><span lang="en-US">GPU </span></font>执行操作<font face="Liberation Serif, serif"><span lang="en-US">:</span></span></font></p>
<pre class="cjk"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">with tf.Session() as sess:</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">  </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">with tf.device(&quot;/gpu:1&quot;):</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">    </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">matrix1 = tf.constant([[3., 3.]])</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">    </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">matrix2 = tf.constant([[2.],[2.]])</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">    </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">product = tf.matmul(matrix1, matrix2)</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">    </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">...</span></code></span></font></pre><p>
<span style="background: #ffff00">设备用字符串进行标识<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>目前支持的设备包括<font face="Liberation Serif, serif"><span lang="en-US">:</span></span></font></p>
<ul>
	<li/>
<p style="margin-bottom: 0cm"><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">&quot;/cpu:0&quot;</span></code><span style="background: #ffff00">:
	</span></span></font><span style="background: #ffff00">机器的
	<font face="Liberation Serif, serif"><span lang="en-US">CPU. </span></span></font>
	</p>
	<li/>
<p style="margin-bottom: 0cm"><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">&quot;/gpu:0&quot;</span></code><span style="background: #ffff00">:
	</span></span></font><span style="background: #ffff00">机器的第一个
	<font face="Liberation Serif, serif"><span lang="en-US">GPU, </span></font>如果有的话<font face="Liberation Serif, serif"><span lang="en-US">.
	</span></span></font>
	</p>
	<li/>
<p><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">&quot;/gpu:1&quot;</span></code><span style="background: #ffff00">:
	</span></span></font><span style="background: #ffff00">机器的第二个
	<font face="Liberation Serif, serif"><span lang="en-US">GPU, </span></font>以此类推<font face="Liberation Serif, serif"><span lang="en-US">.
	</span></span></font>
	</p>
</ul>
<p><span style="background: #ffff00">阅读<a href="tensorflow-zh/SOURCE/how_tos/using_gpu.html">使用<font face="Liberation Serif, serif"><span lang="en-US">GPU</a></span></font>章节<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>了解 <font face="Liberation Serif, serif"><span lang="en-US">TensorFlow
GPU </span></font>使用的更多信息<font face="Liberation Serif, serif"><span lang="en-US">.
</span></span></font>
</p>
<h2><a name="e61efedd255873cb52bc100ac9e2e551"></a><a name="AUTOGENERATED-interactive-usage"></a>
<span style="background: #ffff00">交互式使用 </span>
</h2>
<p><span style="background: #ffff00">文档中的 <font face="Liberation Serif, serif"><span lang="en-US">Python
</span></font>示例使用一个会话 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><a href="../api_docs/python/client.html"><span style="background: #ffff00">Session</span></a></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">来 启动图<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>并调用 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><a href="../api_docs/python/client.html"><span style="background: #ffff00">Session.run()</span></a></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">方法执行操作<font face="Liberation Serif, serif"><span lang="en-US">.
</span></span></font>
</p>
<p><span style="background: #ffff00">为了便于使用诸如 <font face="Liberation Serif, serif"><span lang="en-US"><a href="http://ipython.org/">IPython</a>
</span></font>之类的 <font face="Liberation Serif, serif"><span lang="en-US">Python
</span></font>交互环境<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>可以使用 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><a href="../api_docs/python/client.html"><span style="background: #ffff00">InteractiveSession</span></a></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">代替</span>
<font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">Session</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">类<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>使用 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><a href="../api_docs/python/framework.html"><span style="background: #ffff00">Tensor.eval()</span></a></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">和
</span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><a href="../api_docs/python/framework.html"><span style="background: #ffff00">Operation.run()</span></a></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">方法代替
</span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">Session.run()</span></code><span style="background: #ffff00">.
</span></span></font><span style="background: #ffff00">这样可以避免使用一个变量来持有会话<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<pre class="cjk"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">进入一个交互式 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">TensorFlow </code></span></font><code class="cjk">会话</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">import tensorflow as tf</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">sess = tf.InteractiveSession()</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">x = tf.Variable([1.0, 2.0])</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">a = tf.constant([3.0, 3.0])</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">使用初始化器 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">initializer op </code></span></font><code class="cjk">的 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">run() </code></span></font><code class="cjk">方法初始化 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'x' </span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">x.initializer.run()</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">增加一个减法 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">sub op, </code></span></font><code class="cjk">从 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'x' </code></span></font><code class="cjk">减去 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'a'. </code></span></font><code class="cjk">运行减法 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op, </code></span></font><code class="cjk">输出结果 </span></code>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">sub = tf.sub(x, a)</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">print sub.eval()</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># ==&gt; [-2. -1.]</span></code></span></font></pre><h2>
<a name="8868ae9e92cfadb1f55e8a950d7e8481"></a><a name="AUTOGENERATED-tensors"></a>
<font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">Tensor
</span></span></font>
</h2>
<p><font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">TensorFlow
</span></font>程序使用 <font face="Liberation Serif, serif"><span lang="en-US">tensor
</span></font>数据结构来代表所有的数据<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>计算图中<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>操作间传递的数据都是 <font face="Liberation Serif, serif"><span lang="en-US">tensor.</span>
</span></font><span style="background: #ffff00">你可以把
<font face="Liberation Serif, serif"><span lang="en-US">TensorFlow
tensor </span></font>看作是一个 <font face="Liberation Serif, serif"><span lang="en-US">n
</span></font>维的数组或列表<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>一个 <font face="Liberation Serif, serif"><span lang="en-US">tensor
</span></font>包含一个静态类型 <font face="Liberation Serif, serif"><span lang="en-US">rank,
</span></font>和</span> <span style="background: #ffff00">一个
<font face="Liberation Serif, serif"><span lang="en-US">shape. </span></font>想了解
<font face="Liberation Serif, serif"><span lang="en-US">TensorFlow
</span></font>是如何处理这些概念的<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>参见 <font face="Liberation Serif, serif"><span lang="en-US"><a href="../resources/dims_types.html">Rank,
Shape, </span></font>和 <font face="Liberation Serif, serif"><span lang="en-US">Type</a>.</span></span></font></p>
<h2><a name="83f344691ee557b333e5d96d1c0a3a2c"></a><a name="AUTOGENERATED-variables"></a>
<span style="background: #ffff00">变量 </span>
</h2>
<p><font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00"><a href="../how_tos/variables/index.html">Variables</a>
for more details. </span></font>变量维护图执行过程中的状态信息<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>下面的例子演示了如何使用变量实现一个简单的计数器<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>参见 <a href="tensorflow-zh/how_tos/variables.html">变量</a>
章节了解更多细节<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<pre class="cjk"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">创建一个变量</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">, </code></span></font><code class="cjk">初始化为标量 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">0.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">state = tf.Variable(0, name=&quot;counter&quot;)</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">创建一个 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op, </code></span></font><code class="cjk">其作用是使 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">state </code></span></font><code class="cjk">增加 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">1</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">one = tf.constant(1)</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">new_value = tf.add(state, one)</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">update = tf.assign(state, new_value)</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">启动图后</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">, </code></span></font><code class="cjk">变量必须先经过</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">`</code></span></font><code class="cjk">初始化</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">` (init) op </code></span></font><code class="cjk">初始化</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">,</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">首先必须增加一个</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">`</code></span></font><code class="cjk">初始化</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">` op </code></span></font><code class="cjk">到图中</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">.</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">init_op = tf.initialize_all_variables()</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">启动图</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">, </code></span></font><code class="cjk">运行 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">with tf.Session() as sess:</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">  </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"># </code></span></font><code class="cjk">运行 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'init' op</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">  </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">sess.run(init_op)</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">  </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"># </code></span></font><code class="cjk">打印 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'state' </code></span></font><code class="cjk">的初始值</span></code>
<code class="cjk"><span style="background: #ffff00">  </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">print sess.run(state)</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">  </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"># </code></span></font><code class="cjk">运行 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">op, </code></span></font><code class="cjk">更新 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'state', </code></span></font><code class="cjk">并打印 </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">'state'</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">  </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">for _ in range(3):</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">    </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">sess.run(update)</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">    </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">print sess.run(state)</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">输出</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">:</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># 0</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># 1</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># 2</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># 3</span></code></span></font></pre><p>
<span style="background: #ffff00">代码中 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">assign()</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">操作是图所描绘的表达式的一部分<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>正如 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">add()</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">操作一样<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>所以在调用 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">run()</span></code>
</span></font><span style="background: #ffff00">执行表达式之前<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>它并不会真正执行赋值操作<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<p><span style="background: #ffff00">通常会将一个统计模型中的参数表示为一组变量<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>例如<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>你可以将一个神经网络的权重作为某个变量存储在一个
<font face="Liberation Serif, serif"><span lang="en-US">tensor </span></font>中<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>在训练过程中<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>通过重复运行训练图<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>更新这个 <font face="Liberation Serif, serif"><span lang="en-US">tensor.</span></span></font></p>
<h2><a name="ce40a2a9ac7fe11bd62352ea30237efb"></a><a name="AUTOGENERATED-fetches"></a>
<font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">Fetch
</span></span></font>
</h2>
<p><span style="background: #ffff00">为了取回操作的输出内容<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>可以在使用 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">Session</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">对象的
</span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">run()</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">调用 执行图时<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>传入一些 <font face="Liberation Serif, serif"><span lang="en-US">tensor,
</span></font>这些 <font face="Liberation Serif, serif"><span lang="en-US">tensor
</span></font>会帮助你取回结果<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>在之前的例子里<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>我们只取回了单个节点 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">state</span></code><span style="background: #ffff00">,
</span></span></font><span style="background: #ffff00">但是你也可以取回多个
<font face="Liberation Serif, serif"><span lang="en-US">tensor:</span></span></font></p>
<pre class="cjk"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">input1 = tf.constant(3.0)</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">input2 = tf.constant(2.0)</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">input3 = tf.constant(5.0)</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">intermed = tf.add(input2, input3)</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">mul = tf.mul(input1, intermed)</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">with tf.Session() as sess:</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">  </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">result = sess.run([mul, intermed])</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">  </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">print result</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">输出</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">:</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># [array([ 21.], dtype=float32), array([ 7.], dtype=float32)]</span></code></span></font></pre><p>
<span style="background: #ffff00">需要获取的多个 <font face="Liberation Serif, serif"><span lang="en-US">tensor
</span></font>值，在 <font face="Liberation Serif, serif"><span lang="en-US">op
</span></font>的一次运行中一起获得（而不是逐个去获取
<font face="Liberation Serif, serif"><span lang="en-US">tensor</span></font>）。</span></p>
<h2><a name="b5597ebd8e98f4f7c1a73a27047062d5"></a><a name="AUTOGENERATED-feeds"></a>
<font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">Feed
</span></span></font>
</h2>
<p><span style="background: #ffff00">上述示例在计算图中引入了
<font face="Liberation Serif, serif"><span lang="en-US">tensor,
</span></font>以常量或变量的形式存储<font face="Liberation Serif, serif"><span lang="en-US">.
TensorFlow </span></font>还提供了 <font face="Liberation Serif, serif"><span lang="en-US">feed
</span></font>机制<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>该机制 可以临时替代图中的任意操作中的
<font face="Liberation Serif, serif"><span lang="en-US">tensor
</span></font>可以对图中任何操作提交补丁<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>直接插入一个 <font face="Liberation Serif, serif"><span lang="en-US">tensor.</span></span></font></p>
<p><font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">feed
</span></font>使用一个 <font face="Liberation Serif, serif"><span lang="en-US">tensor
</span></font>值临时替换一个操作的输出结果<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>你可以提供 <font face="Liberation Serif, serif"><span lang="en-US">feed
</span></font>数据作为 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">run()</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">调用的参数<font face="Liberation Serif, serif"><span lang="en-US">.
feed </span></font>只在调用它的方法内有效<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>方法结束<font face="Liberation Serif, serif"><span lang="en-US">,
feed </span></font>就会消失<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>最常见的用例是将某些特殊的操作指定为
<font face="Liberation Serif, serif"><span lang="en-US">&quot;feed&quot;
</span></font>操作<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>标记的方法是使用 <font face="Liberation Serif, serif"><span lang="en-US">tf.placeholder()
</span></font>为这些操作创建占位符<font face="Liberation Serif, serif"><span lang="en-US">.
</span></span></font>
</p>
<pre class="cjk">
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">input1 = tf.placeholder(tf.float32)</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">input2 = tf.placeholder(tf.float32)</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">output = tf.mul(input1, input2)</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">with tf.Session() as sess:</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">  </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">print sess.run([output], feed_dict={input1:[7.], input2:[2.]})</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># </code></span></font><code class="cjk">输出</code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">:</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># [array([ 14.], dtype=float32)]</span></code></span></font></pre><p>
<font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">for
a larger-scale example of feeds. </span></font>如果没有正确提供
<font face="Liberation Serif, serif"><span lang="en-US">feed,
</span><code class="western"><span style="background: #ffff00">placeholder()</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">操作将会产生错误<font face="Liberation Serif, serif"><span lang="en-US">.</span>
<span style="background: #ffff00">MNIST </span></span></font><span style="background: #ffff00">全连通
<font face="Liberation Serif, serif"><span lang="en-US"><a href="http://wiki.jikexueyuan.com/project/tensorflow-zh/tutorials/mnist_tf.html">feed
</span></font>教程</a> <font face="Liberation Serif, serif"><span lang="en-US">(<a href="https://raw.githubusercontent.com/tensorflow/tensorflow/master/tensorflow/examples/tutorials/mnist/fully_connected_feed.py">source
code</a>) </span></font>给出了一个更大规模的使用 <font face="Liberation Serif, serif"><span lang="en-US">feed
</span></font>的例子<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<blockquote><span style="background: #ffff00">原文：<font face="Liberation Serif, serif"><span lang="en-US"><a href="http://tensorflow.org/get_started/basic_usage.md">Basic
Usage</a> </span></font>翻译：<font face="Liberation Serif, serif"><span lang="en-US"><a href="https://github.com/PFZheng">@doc001</a>
</span></font>校对：<font face="Liberation Serif, serif"><span lang="en-US"><a href="https://github.com/sstruct">@yangtze</a></span></span></font></blockquote>
</body>
</html>