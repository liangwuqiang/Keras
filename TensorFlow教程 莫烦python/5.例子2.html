<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 5.1.4.2 (Linux)"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changed" content="2017-09-25T08:09:23.027250113"/>
	<meta name="" content=""/>
	<style type="text/css">
		pre.ctl { font-family: "Liberation Mono", monospace }
		code.ctl { font-family: "Liberation Mono", monospace }
	</style>
</head>
<body lang="zh-CN" dir="ltr">
<p><a href="https://morvanzhou.github.io/tutorials/machine-learning/tensorflow/"><span style="background: #ffff00">原文链接</span></a></p>
<hr/>

<h1><span style="background: #ffff00">例子<font face="Thorndale, serif"><font size="6" style="font-size: 24pt"><span lang="en-US">2</span></span></font></font></h1>
<p align="center"><span style="background: #ffff00">作者<font face="Liberation Serif, serif"><span lang="en-US">:
</span></span></font><strong><span style="background: #ffff00">莫烦</span></strong><span style="background: #ffff00">
&nbsp;&nbsp; 编辑<font face="Liberation Serif, serif"><span lang="en-US">:
</span></span></font><strong><span style="background: #ffff00">莫烦</span></strong><span style="background: #ffff00">
&nbsp;&nbsp; <font face="Liberation Serif, serif"><span lang="en-US">2016-11-03
</span></span></font>
</p>
<p><span style="background: #ffff00">学习资料<font face="Liberation Serif, serif"><span lang="en-US">:</span></span></font></p>
<ul>
	<li/>
<p style="margin-bottom: 0cm"><span style="background: #ffff00"><a href="https://github.com/MorvanZhou/tutorials/tree/master/tensorflowTUT/tf5_example2">相关代码</a>
	</span>
	</p>
	<li/>
<p><span style="background: #ffff00">为 <font face="Liberation Serif, serif"><span lang="en-US">TF
	2017 </span></font>打造的<a href="https://github.com/MorvanZhou/Tensorflow-Tutorial">新版可视化教学代码</a>
	</span>
	</p>
</ul>
<p><font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">Tensorflow
</span></font>是非常重视结构的<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>我们得建立好了神经网络的结构<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>才能将数字放进去<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>运行这个结构<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<p><span style="background: #ffff00">这个例子简单的阐述了
<font face="Liberation Serif, serif"><span lang="en-US">tensorflow
</span></font>当中如何用代码来运行我们搭建的结构<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<h4><a name="创建数据"></a><span style="background: #ffff00">创建数据</span></h4>
<p><span style="background: #ffff00">首先<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>我们这次需要加载 <font face="Liberation Serif, serif"><span lang="en-US">tensorflow
</span></font>和 <font face="Liberation Serif, serif"><span lang="en-US">numpy
</span></font>两个模块<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>并且使用 <font face="Liberation Serif, serif"><span lang="en-US">numpy
</span></font>来创建我们的数据<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<pre class="cjk"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">import tensorflow as tf</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">import numpy as np</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># create data</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">x_data = np.random.rand(100).astype(np.float32)</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">y_data = x_data*0.1 + 0.3</span></code></span></font></pre><p>
<span style="background: #ffff00">接着<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>我们用 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">tf.Variable</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">来创建描述
</span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">y</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">的参数<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>我们可以把 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">y_data
= x_data*0.1 + 0.3</span></code> </span></font><span style="background: #ffff00">想象成
</span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">y=Weights
* x + biases</span></code><span style="background: #ffff00">,
</span></span></font><span style="background: #ffff00">然后神经网络也就是学着把
<font face="Liberation Serif, serif"><span lang="en-US">Weights </span></font>变成
<font face="Liberation Serif, serif"><span lang="en-US">0.1, biases
</span></font>变成</span> <font face="Liberation Serif, serif"><span lang="en-US"><span style="background: #ffff00">0.3.</span></span></font></p>
<h4><a name="搭建模型"></a><span style="background: #ffff00">搭建模型</span></h4>
<pre class="cjk"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">Weights = tf.Variable(tf.random_uniform([1], -1.0, 1.0))</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">biases = tf.Variable(tf.zeros([1]))</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">y = Weights*x_data + biases</span></code></span></font></pre><h4>
<a name="计算误差"></a><span style="background: #ffff00">计算误差</span></h4>
<p><span style="background: #ffff00">接着就是计算 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">y</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">和 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">y_data</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">的误差<font face="Liberation Serif, serif"><span lang="en-US">:</span></span></font></p>
<pre class="cjk" style="margin-bottom: 0.5cm"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">loss = tf.reduce_mean(tf.square(y-y_data))</span></code></span></font></pre><h4>
<a name="传播误差"></a><span style="background: #ffff00">传播误差</span></h4>
<p><span style="background: #ffff00">反向传递误差的工作就教给</span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">optimizer</span></code></span></font><span style="background: #ffff00">了<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>我们使用的误差传递方法是梯度下降法<font face="Liberation Serif, serif"><span lang="en-US">:
</span><code class="western"><span style="background: #ffff00">Gradient</span></code><code class="western">
</code><code class="western"><span style="background: #ffff00">Descent</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">让后我们使用
</span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">optimizer</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">来进行参数的更新<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<pre class="cjk"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">optimizer = tf.train.GradientDescentOptimizer(0.5)</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">train = optimizer.minimize(loss)</span></code></span></font></pre><h4>
<a name="训练"></a><span style="background: #ffff00">训练</span></h4>
<p><span style="background: #ffff00">到目前为止<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>我们只是建立了神经网络的结构<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>还没有使用这个结构<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>在使用这个结构之前<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>我们必须先初始化所有之前定义的</span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">Variable</span></code><span style="background: #ffff00">,
</span></span></font><span style="background: #ffff00">所以这一步是很重要的<font face="Liberation Serif, serif"><span lang="en-US">!</span></span></font></p>
<pre class="cjk"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00"># init = tf.initialize_all_variables() # tf </code></span></font><code class="cjk">马上就要废弃这种写法</span></code>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">init = tf.global_variables_initializer()  # </code></span></font><code class="cjk">替换成这样就好</span></code></pre><p>
<span style="background: #ffff00">接着<font face="Liberation Serif, serif"><span lang="en-US">,</span></font>我们再创建会话
</span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">Session</span></code><span style="background: #ffff00">.
</span></span></font><span style="background: #ffff00">我们会在下一节中详细讲解
<font face="Liberation Serif, serif"><span lang="en-US">Session. </span></font>我们用
</span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">Session</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">来执行</span>
<font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">init</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">初始化步骤<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>并且<font face="Liberation Serif, serif"><span lang="en-US">,
</span></font>用 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">Session</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">来 </span><font face="Liberation Serif, serif"><span lang="en-US"><code class="western"><span style="background: #ffff00">run</span></code><span style="background: #ffff00">
</span></span></font><span style="background: #ffff00">每一次
<font face="Liberation Serif, serif"><span lang="en-US">training </span></font>的数据<font face="Liberation Serif, serif"><span lang="en-US">.
</span></font>逐步提升神经网络的预测准确性<font face="Liberation Serif, serif"><span lang="en-US">.</span></span></font></p>
<pre class="cjk"><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">sess = tf.Session()</span></code></span></font>
<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">sess.run(init)          # Very important</span></code></span></font>

<font face="Liberation Mono, monospace"><span lang="en-US"><code class="western"><span style="background: #ffff00">for step in range(201):</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">    </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">sess.run(train)</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">    </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">if step % 20 == 0:</span></code></span></font>
<code class="cjk"><span style="background: #ffff00">        </code><font face="Liberation Mono, monospace"><span lang="en-US"><code class="western">print(step, sess.run(Weights), sess.run(biases))</span></code></span></font></pre><p>
<br/>
<br/>

</p>
</body>
</html>