<!DOCTYPE html>
    <html><head><meta charset="UTF-8">
    </head><body>
    <p><a href="https://morvanzhou.github.io/tutorials/machine-learning/tensorflow/">原文链接</a></p>
        <div class="tut-main-content-pad">
<br>
<h1>RNN LSTM (回归例子可视化)</h1>
<p style="text-align: center;">
        
          作者: <strong>莫烦</strong>   
        
        编辑: <strong>莫烦</strong>   
        
      </p>
<p>学习资料:</p>
<ul>
<li><a href="https://github.com/MorvanZhou/tutorials/tree/master/tensorflowTUT/tf20_RNN2.2">相关代码</a></li>
<li>为 TF 2017 打造的<a href="https://github.com/MorvanZhou/Tensorflow-Tutorial">新版可视化教学代码</a></li>
<li>机器学习-简介系列 <a href="/tutorials/machine-learning/ML-intro/2-3-RNN/">什么是RNN</a></li>
<li>机器学习-简介系列 <a href="/tutorials/machine-learning/ML-intro/2-4-LSTM/">什么是LSTM RNN</a></li>
</ul>
<p>接着<a href="/tutorials/machine-learning/tensorflow/5-09-RNN3/">上一节的例子</a>继续讲解.
这次, 我们会要可视化整个学习的结果.</p>
<h4 class="tut-h4-pad" id="matplotlib 可视化">matplotlib 可视化</h4>
<p>使用 Matplotlib 模块来进行可视化过程, 在建立好 <code class="highlighter-rouge">model</code> 以后, 设置 <code class="highlighter-rouge">plt.ion()</code> 使 <code class="highlighter-rouge">plt.show()</code>可以连续显示.</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">LSTMRNN</span><span class="p">(</span><span class="n">TIME_STEPS</span><span class="p">,</span> <span class="n">INPUT_SIZE</span><span class="p">,</span> <span class="n">OUTPUT_SIZE</span><span class="p">,</span> <span class="n">CELL_SIZE</span><span class="p">,</span> <span class="n">BATCH_SIZE</span><span class="p">)</span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="c"># sess.run(tf.initialize_all_variables()) # tf 马上就要废弃这种写法</span>
<span class="c"># 替换成下面的写法:</span>
<span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>   <span class="c"># 设置连续 plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>
<p>然后在 <code class="highlighter-rouge">sess.run()</code> 后面加上<code class="highlighter-rouge">plt.draw()</code>的步骤.</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">_</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">train_op</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">cost</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">cell_final_state</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">pred</span><span class="p">],</span>
            <span class="n">feed_dict</span><span class="o">=</span><span class="n">feed_dict</span><span class="p">)</span>
<span class="c"># plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">pred</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[:</span><span class="n">TIME_STEPS</span><span class="p">],</span> <span class="s">'b--'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>  <span class="c"># 每 0.3 s 刷新一次</span>
</code></pre>
</div>
<p>最后的结果显示为:</p>
<p><img alt="RNN LSTM (回归例子可视化)809" class="course-image" src="images/fc87980a3d219025600420bf88ec4d38.png"/></p>
<p style="font-size: 0.8em; padding:4em 1em 0.5em 1em; margin: 0 auto;">
        如果你觉得这篇文章或视频对你的学习很有帮助, 请你也分享它, 让它能再次帮助到更多的需要学习的人.

        莫烦没有正式的经济来源, 如果你也想支持 <strong>莫烦Python</strong> 并看到更好的教学内容, 赞助他一点点, 作为鼓励他继续开源的动力.
      </p>
<!-- donation -->
<div id="bottom-donation-section">
<h3 id="bottom-donation-title">支持 让教学变得更优秀</h3>
<br>
<div>
<a href="/support/" id="bottom-donation-button"><strong>点我 赞助 莫烦</strong></a>
</div>
<br>
</br></br></div>
<hr>
</hr></br></div>
    </body></html>