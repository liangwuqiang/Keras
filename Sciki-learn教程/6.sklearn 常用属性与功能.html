<!DOCTYPE html>
    <html><head><meta charset="UTF-8">
    </head><body>
    <p><a href="https://morvanzhou.github.io/tutorials/machine-learning/sklearn/">原文链接</a></p>
        <div class="tut-main-content-pad">
<hr>
<h1>sklearn 常用属性与功能</h1>
<p style="text-align: center;">
        
          作者: <strong>Alice</strong>   
        
        编辑: <strong>莫烦</strong>   
        
          2016-11-03
        
      </p>
<p>学习资料:</p>
<ul>
<li><a href="https://github.com/MorvanZhou/tutorials/blob/master/sklearnTUT/sk6_model_attribute_method.py">相关代码</a></li>
</ul>
<p>上次学了  <code class="highlighter-rouge">Sklearn</code> 中的 <code class="highlighter-rouge">data sets</code>，今天来看 Model 的属性和功能。</p>
<p>这里以 <code class="highlighter-rouge">LinearRegressor</code> 为例，所以先导入包，数据，还有模型。</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="n">loaded_data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_boston</span><span class="p">()</span>
<span class="n">data_X</span> <span class="o">=</span> <span class="n">loaded_data</span><span class="o">.</span><span class="n">data</span>
<span class="n">data_y</span> <span class="o">=</span> <span class="n">loaded_data</span><span class="o">.</span><span class="n">target</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</code></pre>
</div>
<h4 class="tut-h4-pad" id="训练和预测">训练和预测</h4>
<p>接下来 <code class="highlighter-rouge">model.fit</code> 和 <code class="highlighter-rouge">model.predict</code> 就属于 Model 的功能，用来训练模型，用训练好的模型预测。</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_X</span><span class="p">,</span> <span class="n">data_y</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_X</span><span class="p">[:</span><span class="mi">4</span><span class="p">,</span> <span class="p">:]))</span>

<span class="s">"""
[ 30.00821269  25.0298606   30.5702317   28.60814055]
"""</span>
</code></pre>
</div>
<h4 class="tut-h4-pad" id="参数和分数">参数和分数</h4>
<p>然后，<code class="highlighter-rouge">model.coef_</code> 和 <code class="highlighter-rouge">model.intercept_ </code> 属于 Model 的属性，
例如对于 <code class="highlighter-rouge">LinearRegressor</code> 这个模型，这两个属性分别输出模型的斜率和截距（与y轴的交点）。</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>


<span class="s">"""
[ -1.07170557e-01   4.63952195e-02   2.08602395e-02   2.68856140e+00
  -1.77957587e+01   3.80475246e+00   7.51061703e-04  -1.47575880e+00
   3.05655038e-01  -1.23293463e-02  -9.53463555e-01   9.39251272e-03
  -5.25466633e-01]
36.4911032804
"""</span>
</code></pre>
</div>
<p><code class="highlighter-rouge">model.get_params()</code> 也是功能，它可以取出之前定义的参数。</p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">get_params</span><span class="p">())</span>


<span class="s">"""
{'copy_X': True, 'normalize': False, 'n_jobs': 1, 'fit_intercept': True}
"""</span>
</code></pre>
</div>
<p><code class="highlighter-rouge">model.score(data_X, data_y)</code> 它可以对 Model 用 <code class="highlighter-rouge">R^2</code> 的方式进行打分，输出精确度。关于 <code class="highlighter-rouge">R^2 coefficient of determination</code> 可以查看 <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">wiki</a></p>
<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">data_X</span><span class="p">,</span> <span class="n">data_y</span><span class="p">))</span> <span class="c"># R^2 coefficient of determination</span>

<span class="s">"""
0.740607742865
"""</span>
</code></pre>
</div>
<p style="font-size: 0.8em; padding:4em 1em 0.5em 1em; margin: 0 auto;">
        如果你觉得这篇文章或视频对你的学习很有帮助, 请你也分享它, 让它能再次帮助到更多的需要学习的人.

        莫烦没有正式的经济来源, 如果你也想支持 <strong>莫烦Python</strong> 并看到更好的教学内容, 赞助他一点点, 作为鼓励他继续开源的动力.
      </p>
<!-- donation -->
<div id="bottom-donation-section">
<h3 id="bottom-donation-title">支持 让教学变得更优秀</h3>
<br>
<div>
<a href="/support/" id="bottom-donation-button"><strong>点我 赞助 莫烦</strong></a>
</div>
<br>
</br></br></div>
<hr>
</hr></hr></div>
    </body></html>